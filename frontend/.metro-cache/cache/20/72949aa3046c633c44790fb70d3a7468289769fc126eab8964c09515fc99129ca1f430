{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":87,"index":177}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"../services/notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":178},"end":{"line":3,"column":93,"index":271}}],"key":"PilFUkBfYpg1cVGLNRiWDw/oULQ=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _servicesApi = require(_dependencyMap[1], \"../services/api\");\n  var _servicesNotifications = require(_dependencyMap[2], \"../services/notifications\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n\n    // Check for existing token on app start\n    (0, _react.useEffect)(() => {\n      checkAuthStatus();\n    }, []);\n    const checkAuthStatus = async () => {\n      try {\n        const token = await (0, _servicesApi.getAuthToken)();\n        if (token) {\n          const userData = await _servicesApi.authAPI.getCurrentUser();\n          setUser(userData);\n          // Register for push notifications after successful auth check\n          setupPushNotifications();\n        }\n      } catch (error) {\n        console.log('No valid session found');\n        await (0, _servicesApi.removeAuthToken)();\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const setupPushNotifications = async () => {\n      try {\n        const token = await (0, _servicesNotifications.registerForPushNotificationsAsync)();\n        if (token) {\n          await (0, _servicesNotifications.savePushToken)(token);\n        }\n      } catch (error) {\n        console.error('Push notification setup error:', error);\n      }\n    };\n    const login = async (email, password) => {\n      try {\n        setIsLoading(true);\n        const response = await _servicesApi.authAPI.login(email, password);\n        if (response.access_token) {\n          await (0, _servicesApi.setAuthToken)(response.access_token);\n          setUser(response.user);\n          // Register for push notifications after login\n          setupPushNotifications();\n          return {\n            success: true\n          };\n        }\n        return {\n          success: false,\n          error: 'Invalid response from server'\n        };\n      } catch (error) {\n        const errorMessage = error.response?.data?.detail || 'Login failed. Please check your credentials.';\n        return {\n          success: false,\n          error: errorMessage\n        };\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        await (0, _servicesApi.removeAuthToken)();\n        setUser(null);\n      } catch (error) {\n        console.error('Logout error:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        login,\n        logout\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":108,"map":[[8,2,21,0,"exports"],[8,9,21,0],[8,10,21,0,"AuthProvider"],[8,22,21,0],[8,25,21,0,"AuthProvider"],[8,37,21,0],[9,2,103,0,"exports"],[9,9,103,0],[9,10,103,0,"useAuth"],[9,17,103,0],[9,20,103,0,"useAuth"],[9,27,103,0],[10,2,1,0],[10,6,1,0,"_react"],[10,12,1,0],[10,15,1,0,"require"],[10,22,1,0],[10,23,1,0,"_dependencyMap"],[10,37,1,0],[11,2,2,0],[11,6,2,0,"_servicesApi"],[11,18,2,0],[11,21,2,0,"require"],[11,28,2,0],[11,29,2,0,"_dependencyMap"],[11,43,2,0],[12,2,3,0],[12,6,3,0,"_servicesNotifications"],[12,28,3,0],[12,31,3,0,"require"],[12,38,3,0],[12,39,3,0,"_dependencyMap"],[12,53,3,0],[13,2,3,93],[13,6,3,93,"_reactJsxDevRuntime"],[13,25,3,93],[13,28,3,93,"require"],[13,35,3,93],[13,36,3,93,"_dependencyMap"],[13,50,3,93],[14,2,19,0],[14,8,19,6,"AuthContext"],[14,19,19,17],[14,35,19,20],[14,39,19,20,"createContext"],[14,45,19,33],[14,46,19,33,"createContext"],[14,59,19,33],[14,61,19,63,"undefined"],[14,70,19,72],[14,71,19,73],[15,2,21,7],[15,11,21,16,"AuthProvider"],[15,23,21,28,"AuthProvider"],[15,24,21,29],[16,4,21,31,"children"],[17,2,21,65],[17,3,21,66],[17,5,21,68],[18,4,22,2],[18,10,22,8],[18,11,22,9,"user"],[18,15,22,13],[18,17,22,15,"setUser"],[18,24,22,22],[18,25,22,23],[18,28,22,26],[18,32,22,26,"useState"],[18,38,22,34],[18,39,22,34,"useState"],[18,47,22,34],[18,49,22,48],[18,53,22,52],[18,54,22,53],[19,4,23,2],[19,10,23,8],[19,11,23,9,"isLoading"],[19,20,23,18],[19,22,23,20,"setIsLoading"],[19,34,23,32],[19,35,23,33],[19,38,23,36],[19,42,23,36,"useState"],[19,48,23,44],[19,49,23,44,"useState"],[19,57,23,44],[19,59,23,45],[19,63,23,49],[19,64,23,50],[21,4,25,2],[22,4,26,2],[22,8,26,2,"useEffect"],[22,14,26,11],[22,15,26,11,"useEffect"],[22,24,26,11],[22,26,26,12],[22,32,26,18],[23,6,27,4,"checkAuthStatus"],[23,21,27,19],[23,22,27,20],[23,23,27,21],[24,4,28,2],[24,5,28,3],[24,7,28,5],[24,9,28,7],[24,10,28,8],[25,4,30,2],[25,10,30,8,"checkAuthStatus"],[25,25,30,23],[25,28,30,26],[25,34,30,26,"checkAuthStatus"],[25,35,30,26],[25,40,30,38],[26,6,31,4],[26,10,31,8],[27,8,32,6],[27,14,32,12,"token"],[27,19,32,17],[27,22,32,20],[27,28,32,26],[27,32,32,26,"getAuthToken"],[27,44,32,38],[27,45,32,38,"getAuthToken"],[27,57,32,38],[27,59,32,39],[27,60,32,40],[28,8,33,6],[28,12,33,10,"token"],[28,17,33,15],[28,19,33,17],[29,10,34,8],[29,16,34,14,"userData"],[29,24,34,22],[29,27,34,25],[29,33,34,31,"authAPI"],[29,45,34,38],[29,46,34,38,"authAPI"],[29,53,34,38],[29,54,34,39,"getCurrentUser"],[29,68,34,53],[29,69,34,54],[29,70,34,55],[30,10,35,8,"setUser"],[30,17,35,15],[30,18,35,16,"userData"],[30,26,35,24],[30,27,35,25],[31,10,36,8],[32,10,37,8,"setupPushNotifications"],[32,32,37,30],[32,33,37,31],[32,34,37,32],[33,8,38,6],[34,6,39,4],[34,7,39,5],[34,8,39,6],[34,15,39,13,"error"],[34,20,39,18],[34,22,39,20],[35,8,40,6,"console"],[35,15,40,13],[35,16,40,14,"log"],[35,19,40,17],[35,20,40,18],[35,44,40,42],[35,45,40,43],[36,8,41,6],[36,14,41,12],[36,18,41,12,"removeAuthToken"],[36,30,41,27],[36,31,41,27,"removeAuthToken"],[36,46,41,27],[36,48,41,28],[36,49,41,29],[37,6,42,4],[37,7,42,5],[37,16,42,14],[38,8,43,6,"setIsLoading"],[38,20,43,18],[38,21,43,19],[38,26,43,24],[38,27,43,25],[39,6,44,4],[40,4,45,2],[40,5,45,3],[41,4,47,2],[41,10,47,8,"setupPushNotifications"],[41,32,47,30],[41,35,47,33],[41,41,47,33,"setupPushNotifications"],[41,42,47,33],[41,47,47,45],[42,6,48,4],[42,10,48,8],[43,8,49,6],[43,14,49,12,"token"],[43,19,49,17],[43,22,49,20],[43,28,49,26],[43,32,49,26,"registerForPushNotificationsAsync"],[43,54,49,59],[43,55,49,59,"registerForPushNotificationsAsync"],[43,88,49,59],[43,90,49,60],[43,91,49,61],[44,8,50,6],[44,12,50,10,"token"],[44,17,50,15],[44,19,50,17],[45,10,51,8],[45,16,51,14],[45,20,51,14,"savePushToken"],[45,42,51,27],[45,43,51,27,"savePushToken"],[45,56,51,27],[45,58,51,28,"token"],[45,63,51,33],[45,64,51,34],[46,8,52,6],[47,6,53,4],[47,7,53,5],[47,8,53,6],[47,15,53,13,"error"],[47,20,53,18],[47,22,53,20],[48,8,54,6,"console"],[48,15,54,13],[48,16,54,14,"error"],[48,21,54,19],[48,22,54,20],[48,54,54,52],[48,56,54,54,"error"],[48,61,54,59],[48,62,54,60],[49,6,55,4],[50,4,56,2],[50,5,56,3],[51,4,58,2],[51,10,58,8,"login"],[51,15,58,13],[51,18,58,16],[51,24,58,16,"login"],[51,25,58,23,"email"],[51,30,58,36],[51,32,58,38,"password"],[51,40,58,54],[51,45,58,106],[52,6,59,4],[52,10,59,8],[53,8,60,6,"setIsLoading"],[53,20,60,18],[53,21,60,19],[53,25,60,23],[53,26,60,24],[54,8,61,6],[54,14,61,12,"response"],[54,22,61,20],[54,25,61,23],[54,31,61,29,"authAPI"],[54,43,61,36],[54,44,61,36,"authAPI"],[54,51,61,36],[54,52,61,37,"login"],[54,57,61,42],[54,58,61,43,"email"],[54,63,61,48],[54,65,61,50,"password"],[54,73,61,58],[54,74,61,59],[55,8,63,6],[55,12,63,10,"response"],[55,20,63,18],[55,21,63,19,"access_token"],[55,33,63,31],[55,35,63,33],[56,10,64,8],[56,16,64,14],[56,20,64,14,"setAuthToken"],[56,32,64,26],[56,33,64,26,"setAuthToken"],[56,45,64,26],[56,47,64,27,"response"],[56,55,64,35],[56,56,64,36,"access_token"],[56,68,64,48],[56,69,64,49],[57,10,65,8,"setUser"],[57,17,65,15],[57,18,65,16,"response"],[57,26,65,24],[57,27,65,25,"user"],[57,31,65,29],[57,32,65,30],[58,10,66,8],[59,10,67,8,"setupPushNotifications"],[59,32,67,30],[59,33,67,31],[59,34,67,32],[60,10,68,8],[60,17,68,15],[61,12,68,17,"success"],[61,19,68,24],[61,21,68,26],[62,10,68,31],[62,11,68,32],[63,8,69,6],[64,8,70,6],[64,15,70,13],[65,10,70,15,"success"],[65,17,70,22],[65,19,70,24],[65,24,70,29],[66,10,70,31,"error"],[66,15,70,36],[66,17,70,38],[67,8,70,69],[67,9,70,70],[68,6,71,4],[68,7,71,5],[68,8,71,6],[68,15,71,13,"error"],[68,20,71,23],[68,22,71,25],[69,8,72,6],[69,14,72,12,"errorMessage"],[69,26,72,24],[69,29,72,27,"error"],[69,34,72,32],[69,35,72,33,"response"],[69,43,72,41],[69,45,72,43,"data"],[69,49,72,47],[69,51,72,49,"detail"],[69,57,72,55],[69,61,72,59],[69,107,72,105],[70,8,73,6],[70,15,73,13],[71,10,73,15,"success"],[71,17,73,22],[71,19,73,24],[71,24,73,29],[72,10,73,31,"error"],[72,15,73,36],[72,17,73,38,"errorMessage"],[73,8,73,51],[73,9,73,52],[74,6,74,4],[74,7,74,5],[74,16,74,14],[75,8,75,6,"setIsLoading"],[75,20,75,18],[75,21,75,19],[75,26,75,24],[75,27,75,25],[76,6,76,4],[77,4,77,2],[77,5,77,3],[78,4,79,2],[78,10,79,8,"logout"],[78,16,79,14],[78,19,79,17],[78,25,79,17,"logout"],[78,26,79,17],[78,31,79,29],[79,6,80,4],[79,10,80,8],[80,8,81,6],[80,14,81,12],[80,18,81,12,"removeAuthToken"],[80,30,81,27],[80,31,81,27,"removeAuthToken"],[80,46,81,27],[80,48,81,28],[80,49,81,29],[81,8,82,6,"setUser"],[81,15,82,13],[81,16,82,14],[81,20,82,18],[81,21,82,19],[82,6,83,4],[82,7,83,5],[82,8,83,6],[82,15,83,13,"error"],[82,20,83,18],[82,22,83,20],[83,8,84,6,"console"],[83,15,84,13],[83,16,84,14,"error"],[83,21,84,19],[83,22,84,20],[83,37,84,35],[83,39,84,37,"error"],[83,44,84,42],[83,45,84,43],[84,6,85,4],[85,4,86,2],[85,5,86,3],[86,4,88,2],[86,24,89,4],[86,28,89,4,"_reactJsxDevRuntime"],[86,47,89,4],[86,48,89,4,"jsxDEV"],[86,54,89,4],[86,56,89,5,"AuthContext"],[86,67,89,16],[86,68,89,17,"Provider"],[86,76,89,25],[87,6,90,6,"value"],[87,11,90,11],[87,13,90,13],[88,8,91,8,"user"],[88,12,91,12],[89,8,92,8,"isLoading"],[89,17,92,17],[90,8,93,8,"isAuthenticated"],[90,23,93,23],[90,25,93,25],[90,26,93,26],[90,27,93,27,"user"],[90,31,93,31],[91,8,94,8,"login"],[91,13,94,13],[92,8,95,8,"logout"],[93,6,96,6],[93,7,96,8],[94,6,96,8,"children"],[94,14,96,8],[94,16,98,7,"children"],[95,4,98,15],[96,6,98,15,"fileName"],[96,14,98,15],[96,16,98,15,"_jsxFileName"],[96,28,98,15],[97,6,98,15,"lineNumber"],[97,16,98,15],[98,6,98,15,"columnNumber"],[98,18,98,15],[99,4,98,15],[99,11,99,26],[99,12,99,27],[100,2,101,0],[101,2,103,7],[101,11,103,16,"useAuth"],[101,18,103,23,"useAuth"],[101,19,103,23],[101,21,103,26],[102,4,104,2],[102,10,104,8,"context"],[102,17,104,15],[102,20,104,18],[102,24,104,18,"useContext"],[102,30,104,28],[102,31,104,28,"useContext"],[102,41,104,28],[102,43,104,29,"AuthContext"],[102,54,104,40],[102,55,104,41],[103,4,105,2],[103,8,105,6,"context"],[103,15,105,13],[103,20,105,18,"undefined"],[103,29,105,27],[103,31,105,29],[104,6,106,4],[104,12,106,10],[104,16,106,14,"Error"],[104,21,106,19],[104,22,106,20],[104,67,106,65],[104,68,106,66],[105,4,107,2],[106,4,108,2],[106,11,108,9,"context"],[106,18,108,16],[107,2,109,0],[108,0,109,1],[108,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkAuthStatus","setupPushNotifications","login","logout","useAuth"],"mappings":"AAA;OCoB;YCK;GDE;0BEE;GFe;iCGE;GHS;gBIE;GJmB;iBKE;GLO;CDe;OOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}